<html lang="">

	<head>

		<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&display=swap" rel="stylesheet">

		<script src="resources/demo.js?v=2"></script>

		<title>Crag Charts: Column</title>

		<style>

			:root {
				--bg: #FFFFFF;
				--on-bg: #081b33;
			}
			body {
				background-color: var(--bg);
			}
			.chart-container {
				width: calc(100vw - 32px);
				height: calc(100vh - 70px);
			}
			.menu-button {
				height: 34px;
				width: 34px;
				margin-bottom: 16px;
				margin-right: 16px;
				filter: invert(0.8);
				cursor: pointer;
				transition: all 0.3s;
				display: inline-block;
			}
			.menu-button:hover {
				transform: scale(1.1);
			}
			#menu-modal {
				position: fixed;
				color: var(--on-bg);
				background: var(--bg);
				max-height: calc(100vh - 16px);
				max-width: 350px;
				width: calc(100vw - 16px);
				top: 8px;
				left: 8px;
				z-index: 99;
				box-shadow: 0 0 4px 1px rgb(0 0 0 / 40%);
				padding-bottom: 16px;
				border-radius: 8px;
				box-sizing: border-box;
				font-family: 'Roboto', sans-serif;
				overflow: hidden;
				opacity: 0.925;
				user-select: none;
			}
			#menu-modal label {
				display: block;
				margin-top: 8px;
				margin-bottom: 2px;
				margin-left: 16px;
				font-size: 12px;
				opacity: 0.8;
			}
			#menu-modal select,
			#menu-modal button {
				width: calc(100% - 48px);
				padding: 8px;
				border: 1px solid #777777;
				background: transparent;
				color: var(--on-bg);
				border-radius: 4px;
				margin-left: 24px;
				cursor: pointer;
			}
			#menu-modal option {
				background: var(--bg);
			}
			/*#menu-modal button {*/
			/*	border: 1px solid #999999;*/
			/*	border-radius: 4px;*/
			/*	width: calc(100% - 48px);*/
			/*	margin: 8px 24px;*/
			/*	padding: 8px;*/
			/*	background: var(--bg);*/
			/*	color: var(--on-bg);*/
			/*	font-family: 'Roboto', sans-serif;*/
			/*	cursor: pointer;*/
			/*}*/
			#menu-button-close {
				height: 16px;
				margin: 8px 12px;
				cursor: pointer;
				filter: invert(0.8);
			}

			@media screen and (prefers-color-scheme: dark) {
				:root {
					--bg: #081b33;
					--on-bg: #FFFFFF;
				}
				.menu-button {
					filter: invert(0);
				}
				#menu-button-close {
					filter: invert(0);
				}
			}
		</style>

	</head>

	<body>

		<img src="/resources/icons/hamburger-menu.svg" alt="Menu" class="menu-button" onclick="showMenu()">
		<img src="/resources/icons/dice.svg" alt="Random Data" class="menu-button" onclick="newData()" style="float: right; margin-right: 8px;">

		<div id="menu-modal" style="display: none">

			<div id="menu-modal-head" style="width: 100%; background: rgba(50,50,50,0.2); height: 30px;">
				<img src="/resources/icons/cross.svg" alt="Menu" id="menu-button-close" onclick="hideMenu()">
			</div>

			<label>Column Color</label>
			<select onchange="newColumnColor(this)">
				<option value="multi">Default: Multi</option>
				<option value="redGreen">Red/Green</option>
				<option value="orange">Orange</option>
				<option value="green">Green</option>
				<option value="blue">Blue</option>
			</select>

			<label>Column Label Position</label>
			<select onchange="newLabelPos(this)">
				<option value="none">Default: None</option>
				<option value="inside">Inside</option>
				<option value="outside">Outside</option>
			</select>

			<label>Column Label Color</label>
			<select onchange="newLabelColor(this)">
				<option value="auto">Default: Auto</option>
				<option value="match">Match Column</option>
				<option value="blue">Blue</option>
				<option value="green">Green</option>
			</select>

			<label>Axis Format</label>
			<select onchange="newAxisFormat(this)">
				<option value="">Default: No Format</option>
				<option value="time">Time</option>
				<option value="decimal">Decimal</option>
				<option value="currency" data-symbol="GBP">Currency £</option>
				<option value="currency" data-symbol="USD">Currency $</option>
				<option value="currency" data-symbol="EUR">Currency €</option>
			</select>

			<label>Title Text</label>
			<button onclick="newTitle()">Add / Remove</button>

		</div>

		<div id="column-chart" class="chart-container"></div>
		
		<script src="crag/crag.charts.loader.js?v=1"></script>
		<script>

			let chart;

			const themeQuery = window.matchMedia('(prefers-color-scheme: dark)');

			themeQuery.addEventListener('change', () => chart.chartColor = cssVar('bg'));

			new CragLoader(['column'], createChart, '/crag/');

			function createChart() {

				const options = {
					data: dataGenerator(5),
					columns: {
						width: 95,
						rounded: true,
						inset: true,
					},
					vAxis: {
						label: 'A Big Data Set'
					},
					chart: {
						color: cssVar('bg')
					}
				}

				chart = new CragColumn(options).create('column-chart');

			}

		</script>

		<script>

			function showMenu() {

				document.getElementById('menu-modal').style.display = '';

				document.getElementById('menu-modal').style.left = '8px';
				document.getElementById('menu-modal').style.top = '8px';

			}

			function hideMenu() {

				document.getElementById('menu-modal').style.display = 'none';

			}

			function newColumnColor(elem) {

				chart.columnColor = elem.value;

			}

			function newData() {

				chart.newData = dataGenerator(15);

			}

			function newTitle() {

				if (chart.title === '') {

					chart.title = randomName(20);

				} else {

					chart.title = '';

				}

			}

			function newLabelPos(elem) {

				chart.labelPosition = elem.value;

			}

			function newLabelColor(elem) {

				chart.labelColor = elem.value;

			}

			function newAxisFormat(elem) {

				chart.setAxisFormat(elem.value, elem.options[elem.selectedIndex].dataset.symbol);

			}

			document.getElementById('menu-modal-head').ondragstart = function() {
				return false;
			};

			document.getElementById('menu-modal-head').onmousedown = function(event) {

				let shiftX = event.clientX - document.getElementById('menu-modal').getBoundingClientRect().left;
				let shiftY = event.clientY - document.getElementById('menu-modal').getBoundingClientRect().top;

				// centers the ball at (pageX, pageY) coordinates
				function moveAt(pageX, pageY) {
					document.getElementById('menu-modal').style.left = pageX - shiftX + 'px';
					document.getElementById('menu-modal').style.top = pageY - shiftY + 'px';
				}

				// move our absolutely positioned ball under the pointer
				moveAt(event.pageX, event.pageY);

				function onMouseMove(event) {
					moveAt(event.pageX, event.pageY);
				}

				// (2) move the ball on mousemove
				document.addEventListener('mousemove', onMouseMove);

				// (3) drop the ball, remove unneeded handlers
				document.getElementById('menu-modal').onmouseup = function() {
					document.removeEventListener('mousemove', onMouseMove);
					document.getElementById('menu-modal').onmouseup = null;
				};

			};

		</script>

	</body>

</html>